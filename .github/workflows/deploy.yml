name: Deploy to GitHub Pages

on:
  push:
    branches: [main]   # Se ejecuta cuando hay cambios en la rama `main`
  workflow_dispatch:     # También puedes ejecutar este flujo de trabajo manualmente

permissions:
  contents: read        # Necesita acceso para leer el repositorio
  pages: write          # Necesita permisos para escribir en GitHub Pages
  id-token: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # Paso 1: Hacer checkout del repositorio
      - name: Checkout repository
        uses: actions/checkout@v4

      # Paso 2: Configurar Node.js (si es necesario)
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'   # Configura la versión de Node.js que usa tu proyecto

      # Paso 3: Instalar dependencias
      - name: Install dependencies
        run: npm install   # Este comando instala todas las dependencias de tu proyecto

      # Paso 4: Construir el sitio
      - name: Build the project
        run: npm run build   # Este comando construye tu sitio, generando los archivos estáticos en una carpeta como `dist` o `static`

  deploy:
    needs: build           # Este trabajo depende del trabajo de construcción
    runs-on: ubuntu-latest
    steps:
      # Paso 1: Hacer checkout del repositorio nuevamente
      - name: Checkout repository
        uses: actions/checkout@v4

      # Paso 2: Desplegar el sitio generado en la carpeta `dist` o `static` a GitHub Pages
      - name: Deploy to GitHub Pages
        uses: actions/deploy-pages@v4
        with:
          folder: ./dist    # Asegúrate de poner la carpeta correcta donde se construyó tu sitio (puede ser `dist` o `static` dependiendo de tu configuración)
